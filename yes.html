<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Love Heart Animation</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #000;
      overflow: hidden;
    }
    #pinkboard {
      position: absolute;
      width: 100vw;
      height: 100vh;
      left: 0; top: 0;
      z-index: 1;
    }
    #side-img {
      position: absolute;
      left: 8vw; /* ปรับระยะห่างจากขอบซ้าย */
      top: 50%;
      transform: translateY(-50%);
      width: 400px; /* ปรับขนาดให้เหมาะสม */
      max-width: 25vw;
      z-index: 2;
      pointer-events: none;
      user-select: none;
    }
    #lyrics {
      position: absolute;
      left: 8vw; /* ขยับจาก 3vw เป็น 8vw */
      top: 50%;
      transform: translateY(-50%);
      color: #fff;
      font-size: 1.7vw;
      width: 28vw;
      z-index: 3;
      text-align: left;
      text-shadow: 2px 2px 8px #000;
      line-height: 1.5;
      pointer-events: none;
      user-select: none;
    }
  </style>
</head>
<body>
  <canvas id="pinkboard"></canvas>
  <div id="lyrics"></div>
  <audio id="bg-music" src="music.mp3" autoplay loop></audio>
  <script>
/*
 * Settings
 */
var settings = {
  particles: {
    length:   500, 
    duration:   2, 
    velocity: 100, 
    effect: -0.75, 
    size:      30, 
  },
};

(function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h,e){var d=new Date().getTime();var f=Math.max(0,16-(d-b));var g=window.setTimeout(function(){h(d+f)},f);b=d+f;return g}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)}}})();

var Point = (function() {

  function Point(x, y) {

    this.x = (typeof x !== 'undefined') ? x : 0;

    this.y = (typeof y !== 'undefined') ? y : 0;

  }

  Point.prototype.clone = function() {

    return new Point(this.x, this.y);

  };

  Point.prototype.length = function(length) {

    if (typeof length == 'undefined')

      return Math.sqrt(this.x * this.x + this.y * this.y);

    this.normalize();

    this.x *= length;

    this.y *= length;

    return this;

  };

  Point.prototype.normalize = function() {

    var length = this.length();

    this.x /= length;

    this.y /= length;

    return this;

  };

  return Point;

})();


/*

 * Particle class

 */

var Particle = (function() {

  function Particle() {

    this.position = new Point();

    this.velocity = new Point();

    this.acceleration = new Point();

    this.age = 0;

  }

  Particle.prototype.initialize = function(x, y, dx, dy) {

    this.position.x = x;

    this.position.y = y;

    this.velocity.x = dx;

    this.velocity.y = dy;

    this.acceleration.x = dx * settings.particles.effect;

    this.acceleration.y = dy * settings.particles.effect;

    this.age = 0;

  };

  Particle.prototype.update = function(deltaTime) {

    this.position.x += this.velocity.x * deltaTime;

    this.position.y += this.velocity.y * deltaTime;

    this.velocity.x += this.acceleration.x * deltaTime;

    this.velocity.y += this.acceleration.y * deltaTime;

    this.age += deltaTime;

  };

  Particle.prototype.draw = function(context, image) {

    function ease(t) {

      return (--t) * t * t + 1;

    }

    var size = image.width * ease(this.age / settings.particles.duration);

    context.globalAlpha = 1 - this.age / settings.particles.duration;

    context.drawImage(image, this.position.x - size / 2, this.position.y - size / 2, size, size);

  };

  return Particle;

})();


var ParticlePool = (function() {

  var particles,

      firstActive = 0,

      firstFree   = 0,

      duration    = settings.particles.duration;

 

  function ParticlePool(length) {


    particles = new Array(length);

    for (var i = 0; i < particles.length; i++)

      particles[i] = new Particle();

  }

  ParticlePool.prototype.add = function(x, y, dx, dy) {

    particles[firstFree].initialize(x, y, dx, dy);

    firstFree++;

    if (firstFree   == particles.length) firstFree   = 0;

    if (firstActive == firstFree       ) firstActive++;

    if (firstActive == particles.length) firstActive = 0;

  };

  ParticlePool.prototype.update = function(deltaTime) {

    var i;

    if (firstActive < firstFree) {

      for (i = firstActive; i < firstFree; i++)

        particles[i].update(deltaTime);

    }

    if (firstFree < firstActive) {

      for (i = firstActive; i < particles.length; i++)

        particles[i].update(deltaTime);

      for (i = 0; i < firstFree; i++)

        particles[i].update(deltaTime);

    }

    while (particles[firstActive].age >= duration && firstActive != firstFree) {

      firstActive++;

      if (firstActive == particles.length) firstActive = 0;

    }

  };

  ParticlePool.prototype.draw = function(context, image) {
    if (firstActive < firstFree) {

      for (i = firstActive; i < firstFree; i++)

        particles[i].draw(context, image);

    }

    if (firstFree < firstActive) {

      for (i = firstActive; i < particles.length; i++)

        particles[i].draw(context, image);

      for (i = 0; i < firstFree; i++)

        particles[i].draw(context, image);

    }

  };

  return ParticlePool;

})();


(function(canvas) {

  var context = canvas.getContext('2d'),

      particles = new ParticlePool(settings.particles.length),

      particleRate = settings.particles.length / settings.particles.duration, // particles/sec

      time;

  function pointOnHeart(t) {

    return new Point(

      160 * Math.pow(Math.sin(t), 3),

      130 * Math.cos(t) - 50 * Math.cos(2 * t) - 20 * Math.cos(3 * t) - 10 * Math.cos(4 * t) + 25

    );

  }

  var image = (function() {

    var canvas  = document.createElement('canvas'),

        context = canvas.getContext('2d');

    canvas.width  = settings.particles.size;

    canvas.height = settings.particles.size;

    function to(t) {

      var point = pointOnHeart(t);

      point.x = settings.particles.size / 2 + point.x * settings.particles.size / 350;

      point.y = settings.particles.size / 2 - point.y * settings.particles.size / 350;

      return point;

    }

    context.beginPath();

    var t = -Math.PI;

    var point = to(t);

    context.moveTo(point.x, point.y);

    while (t < Math.PI) {

      t += 0.01; 

      point = to(t);

      context.lineTo(point.x, point.y);

    }

    context.closePath();

    context.fillStyle = '#ea80b0';

    context.fill();

    var image = new Image();

    image.src = canvas.toDataURL();

    return image;

  })();


  function render() {

    requestAnimationFrame(render);

    var newTime   = new Date().getTime() / 1000,

        deltaTime = newTime - (time || newTime);

    time = newTime;

    context.clearRect(0, 0, canvas.width, canvas.height);

    var amount = particleRate * deltaTime;

    for (var i = 0; i < amount; i++) {

      var pos = pointOnHeart(Math.PI - 2 * Math.PI * Math.random());

      var dir = pos.clone().length(settings.particles.velocity);

      particles.add(canvas.width / 2 + pos.x + 300, canvas.height / 2 - pos.y, dir.x, -dir.y);

    }

    particles.update(deltaTime);

    particles.draw(context, image);

  }

  function onResize() {

    canvas.width  = canvas.clientWidth;

    canvas.height = canvas.clientHeight;

  }

  window.onresize = onResize;

  setTimeout(function() {

    onResize();

    render();

  }, 10);

})(document.getElementById('pinkboard'));

const lyrics = [
  { time: 0, text: "รัก รัก รัก รัก รัก รัก รัก ใช่ไหมคำพูดที่รอคอย" },
  { time: 10, text: "ที่รักช่วยใจเย็น ๆ ไม่ชอบเลยนะเธอคำราม" },
  { time: 13, text: "ถ้าให้พิสูจน์ทุกการกระทำแทนคำว่ารักฉันชำนาญ" },
  { time: 17, text: "เพราะมองคำว่ารักเปรียบดั่งแสงประภาคาร" },
  { time: 20, text: "แล้วเธอล่ะ มองคำว่ารักเป็นกิริยาหรือคำนาม" },
  { time: 24, text: "ไม่ต้องถามหาเหตุผลหรือสงสัยในคำตอบ" },
  { time: 27, text: "ยามเธอทุกข์ไม่มีสุข ฉันมีมุขแทนคำปลอบ" },
  { time: 31, text: "จะเข้าไปทีละนิดกุมมือเธอไว้แล้วก็กอด" },
  { time: 34, text: "หากมีทางเข้าไม่ว่ายังไงก็ต้องมีทางออก" },
  { time: 38, text: "หากว่าเธอนั้นไม่แน่ใจ ให้เธอลองมองย้อนดูใหม่" },
  { time: 45, text: "การกระทำหรือคำหวานที่เธอต้องการ" },
  { time: 51, text: "คนบางคนใช้คำบางคำพูดไปงั้น ๆ อย่างเลื่อนลอย" },
  { time: 57, text: "ฉันพูดน้อยเพียงเพราะฉันต้องการให้คำมันดูมีความหมาย" },
  { time: 65, text: "รัก รัก รัก รัก รัก รัก รัก ใช่ไหมคำพูดที่รอคอย" },
  { time: 72, text: "พูดให้แล้ว อย่าพึ่งนอยทำใจน้อยไปเลยนะ โธ่ ที่รัก" },
  { time: 80, text: "อยากบอกทุกความในใจทั้งหมด แต่คงร่ายไม่หมดในวันสองวัน" },
  { time: 83, text: "แค่ขอให้รู้ไว้เพียงสิ่งเดียวว่าทุก ๆ วันคือวันสำคัญ" },
  { time: 87, text: "ผมทำเป็นประจำ ทำอาหารให้คุณกินอ่ะ" },
  { time: 90, text: "งานบ้านเป็นเรื่องชิน ไม่ต้องนับปฏิทินเพราะผมนั้นพร้อมและยอมเต็มใจ" },
  { time: 94, text: "หากคุณต้องการสิ่งใด (yeah) หากคุณหนาวหรือต้องการผิงไฟ (whoo!)" },
  { time: 97, text: "แค่อยู่นิ่ง ๆ ให้ผมจัดการ ปฏิบัติการปรนนิบัติคุณนะคนดี" },
  { time: 101, text: "นวดไหล่คืองานถนัดอ่ะ เหนื่อยไหมทำงานมาหนัก" },
  { time: 104, text: "มานี่มานอนบนตัก แล้วผมจะกล่อมให้หลับให้ไหลนะ" },
  { time: 140, text: "คนบางคนใช้คำบางคำพูดไปงั้น ๆ อย่างเลื่อนลอย" },
  { time: 147, text: "ฉันพูดน้อยเพียงเพราะฉันต้องการให้คำมันดูมีความหมาย" },
  { time: 153, text: "รัก รัก รัก รัก รัก รัก รัก ใช่ไหมคำพูดที่รอคอย" },
  { time: 160, text: "พูดให้แล้ว อย่าพึ่งนอยทำใจน้อยไปเลยนะ โธ่ ที่รัก" },
  { time: 168, text: "คนบางคนใช้คำบางคำพูดไปงั้น ๆ อย่างเลื่อนลอย" },
  { time: 174, text: "ฉันพูดน้อยเพียงเพราะฉันต้องการให้คำมันดูมีความหมาย" },
  { time: 181, text: "รัก รัก รัก รัก รัก รัก รัก ใช่ไหมคำพูดที่รอคอย" },
  { time: 188, text: "พูดให้แล้ว อย่าพึ่งนอยทำใจน้อยไปเลยนะ โธ่ ที่รัก" },
  { time: 195, text: "ฉันรักเธอ" },
  { time: 197, text: "คุณคงไม่ได้สังเกต" },
  { time: 197, text: "เอ็นดูคุณสุดหัวใจ (รัก รัก รัก รัก รัก รัก รัก)" },
  { time: 206, text: "บางทีอาจดูน้อยไป" },
  { time: 202, text: "ที่รักอย่าเพิ่งน้อยใจ (รัก รัก รัก รัก รัก รัก รัก)" },
  { time: 228, text: "คุณคงไม่ได้สังเกต" },
  { time: 235, text: "เอ็นดูคุณสุดหัวใจ (รัก รัก รัก รัก รัก รัก รัก)" },
  { time: 240, text: "บางทีอาจดูน้อยไป" },
];

const audio = document.getElementById('bg-music');
const lyricsDiv = document.getElementById('lyrics');

function showLyrics() {
  let current = 0;
  function updateLyrics() {
    while (current < lyrics.length - 1 && audio.currentTime >= lyrics[current + 1].time) {
      current++;
    }
    lyricsDiv.textContent = lyrics[current].text;
    if (audio.currentTime < lyrics[0].time) {
      current = 0;
      lyricsDiv.textContent = lyrics[0].text;
    }
    requestAnimationFrame(updateLyrics);
  }
  updateLyrics();
}

audio.addEventListener('play', showLyrics);
audio.addEventListener('seeked', showLyrics);
audio.addEventListener('ended', function() {
  lyricsDiv.textContent = lyrics[0].text;
});

    window.addEventListener('click', function playMusicOnce() {
      const audio = document.getElementById('bg-music');
      if (audio.paused) audio.play();
      window.removeEventListener('click', playMusicOnce);
    });
  </script>

 </BODY>

</HTML>
</body>
</html>




